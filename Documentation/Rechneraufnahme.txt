Spezifikation der Rechneraufnahme für LINBO
-------------------------------------------

In der paedML Linux 3.0 werden die Daten der Clientrechner in der
Datei /etc/linuxmuster/workstations vorgehalten.
Das Format sieht folgendermaßen aus:

r100;r100-pc1;ide60g;00:0C:29:D7:DB:BF;10.32.100.1;255.240.0.0;1;1;1;1;22
r100;r100-pc2;ide60g;00:0C:29:4C:F4:AE;10.32.100.2;255.240.0.0;1;1;1;1;22
r100;r100-pc3;ide60g;00:11:2F:5F:D5:E4;10.32.100.3;255.240.0.0;1;1;1;1;22
r100;r100-pc4;ide60g;00:19:DB:8A:5D:EC;10.32.100.4;255.240.0.0;1;1;1;1;22

Erklärung der einzelnen Felder:
 1. Feld: Raumbezeichnung
 2. Feld: Hostname
 3. Feld: Rechnergruppe
 4. Feld: MAC-Adresse
 5. Feld: IP-Adresse
 6. Feld: Netzmaske
 7. -
10. Feld: historisch bedingte Altlast, hat immer Wert "1"
11. Feld: PXE-Flag, 0 = Rechner bootet nicht über PXE,
          jeder andere Wert bedeutet: Rechner bootet über PXE.
          Für LINBO ist jeder Rechner ein PXE-Rechner, die
          LINBO-Rechneraufnahme schreibt hier also am besten immer
          eine "22" rein.

Aus den Werten dieser Datei erzeugt das paedML eigene import_workstations-
Skript die notwendigen Einträge für den DHCP, legt Samba-Maschinen-
Accounts für jeden Host an und erstellt, falls nicht vorhanden, aus der
default start.conf eine start.conf.<Rechnergruppe> und verlinkt diese
mit der Rechner spezifischen start.conf-<IP-Adresse>.

Rechner, die nicht importiert wurden, haben nur eingeschränkte
Rechte im Netz und bekommen vom DHCP den Hostnamen "pxeclient" und eine
IP-Adresse aus der Range 10.x.1.100/12 - 10.x.1.200/12 zugewiesen, lassen
sich also leicht identifieren.

Bootet also ein Rechner mit dem Hostnamen "pxeclient" erscheint auf der
LINBO-Gui zunächst der Passworteingabedialog "Geben Sie für die
Rechneraufnahme das LINBO-Root-Passwort ein."
(Der Authentifierungszwang hat keine Prio und kann erstmal weggelassen werden.
Evtl. konfigurierbar im globalen Teil der start.conf?)

Nach erfolgreicher Authentifizierung erfasst die Eingabemaske der
LINBO-Rechneraufnahme folgende Daten:
- Raumbezeichnung
- Rechnername
- IP-Adresse
- Rechnergruppe

Eingabeerleichterung:
Vorbelegung der Eingabefelder mit den Werten aus der letzten Zeile von
/etc/linuxmuster/workstations, wobei Rechnername und IP-Adresse um eins
hochgezählt werden, also aus r100-pc01 wird dann r100-pc02, aus 10.16.100.1
wird 10.16.100.2 usw.
Dazu muss wohl /etc/linuxmuster/workstations nach /var/linbo/workstations
verlinkt werden, damit rsync Zugriff darauf hat.

Für gültige Raumbezeichnungen und Rechnernamen gelten die RFC-Spezifikationen
für Hostnamen. Die Bezeichnung der Rechnergruppe darf nur [a-z0-9_] enthalten.
Für die Plausibilitätsüberprüfung der IP-Adresse muss man folgendes Wissen:
Wir bilden unsere Netze mit der Netzmaske 255.240.0.0, d.h. es sind Netz-IPs
von 10.16.0.0/12 bis 10.224.0.0/12 möglich.
Verbotene IP-Adressen für Clients sind also:
- alle die außerhalb der Netzmaske liegen,
- alle mit einer Null im 3. oder 4. Oktett und
- alle mit einer "1" im 3. Oktett.

Nach erfolgreicher Eingabe mit Plausibilitätsüberprüfung werden die Rechnerdaten
im Format der workstations-Datei (s.o.) auf den Server übertragen und dort
als Zeile an die Datei /etc/linuxmuster/workstations angehängt (rsync-Postbefehl?).
Anschließend fährt der Client automatisch herunter.


Thomas Schmitt
28.9.2007
